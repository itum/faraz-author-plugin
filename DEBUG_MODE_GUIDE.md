# راهنمای حالت عیب‌یابی افزونه ادمین هوشمند

## فعال‌سازی حالت عیب‌یابی

برای فعال‌سازی حالت عیب‌یابی، مراحل زیر را دنبال کنید:

### 1. ورود به تنظیمات افزونه
- به پنل مدیریت وردپرس بروید
- از منوی "ادمین هوشمند" گزینه "تنظیمات متاباکس‌ها" را انتخاب کنید

### 2. فعال‌سازی گزینه عیب‌یابی
- در صفحه تنظیمات، گزینه "حالت عیب‌یابی" را پیدا کنید
- تیک این گزینه را بزنید
- روی "ذخیره تغییرات" کلیک کنید

## قابلیت‌های حالت عیب‌یابی

### فایل لاگ مرکزی
- تمام لاگ‌ها در فایل `debug.log` در پوشه `wp-content` ذخیره می‌شوند
- این فایل شامل تمام عملیات افزونه با timestamp دقیق است

### لاگ‌گیری در بخش‌های مختلف

#### 1. گزارش نویسی خودکار (auto-report.php)
- لاگ تمام عملیات تولید گزارش
- ثبت خطاها و موفقیت‌ها
- لاگ ارتباط با API

#### 2. تلگرام (telegram-settings.php)
- لاگ تمام درخواست‌های webhook
- ثبت callback query ها
- لاگ ارسال پیام‌ها
- لاگ خطاهای اتصال

#### 3. واتس‌اپ (newsroom.php)
- لاگ ارسال پیام‌ها به گروه واتس‌اپ
- ثبت پاسخ‌های API
- لاگ خطاهای اتصال

### مشاهده لاگ‌ها

#### روش 1: از طریق تنظیمات
- در صفحه تنظیمات، اگر حالت عیب‌یابی فعال باشد
- دکمه "مشاهده فایل لاگ" نمایش داده می‌شود
- با کلیک روی آن می‌توانید فایل debug.log را مشاهده کنید

#### روش 2: دسترسی مستقیم
- فایل `debug.log` در پوشه `wp-content` قرار دارد
- می‌توانید مستقیماً این فایل را باز کنید

#### روش 3: فایل تست
- فایل `test-debug.php` را اجرا کنید
- این فایل وضعیت دیباگ و محتوای لاگ‌ها را نمایش می‌دهد

## فرمت لاگ‌ها

هر خط لاگ شامل موارد زیر است:
```
[2024-01-15 14:30:25] [INFO] پیام لاگ
```

### انواع لاگ
- `INFO`: اطلاعات عمومی
- `ERROR`: خطاها
- `WARNING`: هشدارها
- `TELEGRAM`: لاگ‌های مربوط به تلگرام
- `WHATSAPP`: لاگ‌های مربوط به واتس‌اپ
- `TEST`: لاگ‌های تست

## نکات مهم

### 1. عملکرد
- حالت دیباگ فقط زمانی فعال می‌شود که گزینه مربوطه در تنظیمات فعال باشد
- در حالت غیرفعال، هیچ لاگی ثبت نمی‌شود

### 2. امنیت
- فایل debug.log شامل اطلاعات حساس است
- توصیه می‌شود این فایل را از دسترسی عمومی محافظت کنید

### 3. حجم فایل
- فایل لاگ ممکن است با گذشت زمان بزرگ شود
- توصیه می‌شود به طور منظم فایل را پاک کنید

### 4. عیب‌یابی
اگر لاگ‌ها ثبت نمی‌شوند:
1. بررسی کنید که گزینه دیباگ فعال باشد
2. مجوزهای نوشتن در پوشه wp-content را بررسی کنید
3. فایل test-debug.php را اجرا کنید

## مثال‌های لاگ

### لاگ تلگرام
```
[2024-01-15 14:30:25] [INFO] === NEW REQUEST ===
[2024-01-15 14:30:25] [INFO] Processing message: /start
[2024-01-15 14:30:25] [INFO] === CALLBACK QUERY DETECTED ===
```

### لاگ واتس‌اپ
```
[2024-01-15 14:30:25] [WHATSAPP] Starting to send post ID: 123 to WhatsApp
[2024-01-15 14:30:25] [WHATSAPP] Message sent successfully to WhatsApp group.
```

### لاگ گزارش نویسی
```
[2024-01-15 14:30:25] [INFO] === WEBHOOK TEST ===
[2024-01-15 14:30:25] [INFO] Webhook endpoint is working!
``` 